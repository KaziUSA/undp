{% extends 'frontend.html.twig' %}

{% block body %}
	<section class="content img-cover" style="{% if entity.path != NULL %}background-image: url({{ entity.file_path }}{{ entity.path }});{% endif %}">
		<div class="transparent-grd"></div>
		<div class="content-area relative">
			{% if is_granted('IS_AUTHENTICATED_FULLY') %}
      <a href="{{ path('page_edit', { 'slug': entity.slug }) }}" class="edit-link">Edit Featured Image</a>
      {% endif %}
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-8">
						<div class="banner-caption">
						 {% if is_granted('IS_AUTHENTICATED_FULLY') %}
								<div class="caption-head"><article id="content1" class="ckeditor" contenteditable="true">
	        						{{ entity.title | raw}}
	    						</article></div>
								<p><article id="content2" class="ckeditor" contenteditable="true">
	        						{{ entity.description | raw }}
	    						</article></p>
    						<input type="button" id="save" class="btn btn-bordered pull-right" value="Save">
						    
						 {% else %}
								<div class="caption-head">
	        						{{ entity.title | raw}}
	    						</div>
								<p>
	        						{{ entity.description | raw }}
	    						</p>
						 {% endif %}
						
							<a href="{{ path('platform') }}" class="btn btn-bordered">
								Go to Platform
							</a>
							<img id="loader" class="hide" src="img/frontend/loading.GIF">
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
{% endblock %}
{%block scriptIncludes %}

<script type="text/javascript" src="/bundles/ivoryckeditor/ckeditor.js"></script>

<script>
var i=0, j=0;
//$("#content1, #content2").keyup(function()
$('#save').click(function()
 {  
  var name = {id:{{ entity.id }}, title:$("#content1").html(), description:$("#content2").html()};
  i=i+1;
  $("#loader").removeClass("hide");
  $("#loader").addClass("show");
  //console.log("Request Sent");
	    $.post('{{path('page')}}',               
	        { data_id:name.id,data_title:name.title,data_description:name.description}, 
	            function(response){
	            	j=j+1
	            	if (j==i){
		            	//console.log("hidden");
						$("#loader").removeClass("show");
						$("#loader").addClass("hide");	
					}

	            }        
	    );
	    return false;
  });
</script>

{% endblock %}
